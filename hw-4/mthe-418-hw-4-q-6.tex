% region Filename parsing.
% Provides macros manipulating strings of tokens.
\RequirePackage{xstring}

% Store the jobname as a string with category 11 characters.
\edef\normaljobname{\expandafter\scantokens\expandafter{\jobname\noexpand}}
\StrBetween{\normaljobname}{hw-}{-q}[\homeworknumber]
\StrBehind{\normaljobname}{-q-}[\questionnumber]
% endregion Filename parsing.

\documentclass[
  coursecode={MTHE 418},
  assignmentname={Homework \homeworknumber},
  studentnumber=20053722,
  name={Bryan Hoang},
  draft,
  % final,
]{
  ltxanswer%
}

\usepackage{bch-style}

\begin{document}
  \begin{questions}
    \setcounter{question}{\questionnumber}
    \addtocounter{question}{-1}
    \question[10]
    \begin{solution}
      Verifying the signature \((S_{1}, S_{2})\) yields
      \begin{align*}
        A^{S_{1}} S_{1}^{S_{2}}             &\equiv 4250^{4129} \cdot 4129^{5575} \pmod{6961} \\
                                            &\equiv 231 \pmod{6961},                          \\
        g^{D}                               &\equiv 437^{1521} \pmod{6961}                    \\
                                            &\equiv 231 \pmod{6961},                          \\
        \Rightarrow A^{S_{1}} S_{1}^{S_{2}} &\equiv g^{D} \pmod{p}.
      \end{align*}
      Therefore, \fbox{the signature \((S_{1}, S_{2})\) is valid}.

      Verifying the signature \((S'_{1}, S'_{2})\) yields
      \begin{align*}
        A^{S'_{1}} S_{1}^{\prime S'_{2}}             &\equiv 4250^{3145} \cdot 3145^{1871} \pmod{6961} \\
                                                     &\equiv 6208  \pmod{6961},                        \\
        g^{D}                                        &\equiv 437^{1837} \pmod{6961}                    \\
                                                     &\equiv 2081 \pmod{6961},                         \\
        \Rightarrow A^{S'_{1}} S_{1}^{\prime S'_{2}} &\not\equiv g^{D} \pmod{p}.
      \end{align*}
      Therefore, \fbox{the signature \((S'_{1}, S'_{2})\) is not valid}.

      Verifying the signature \((S_{1}^{\prime\prime}, S_{2}^{\prime\prime})\) yields
      \begin{align*}
        A^{S_{1}^{\prime\prime}} S_{1}^{\prime\prime S_{2}^{\prime\prime}}             &\equiv 4250^{2709} \cdot 2709^{2994} \pmod{6961} \\
                                                                                       &\equiv 2243 \pmod{6961},                         \\
        g^{D}                                                                          &\equiv 437^{1614} \pmod{6961}                    \\
                                                                                       &\equiv 2243 \pmod{6961},                         \\
        \Rightarrow A^{S_{1}^{\prime\prime}} S_{1}^{\prime\prime S_{2}^{\prime\prime}} &\equiv g^{D} \pmod{p}.
      \end{align*}
      Therefore, \fbox{the signature \((S_{1}^{\prime\prime}, S_{2}^{\prime\prime})\) is valid}.
    \end{solution}
  \end{questions}
\end{document}
